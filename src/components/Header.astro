---
const base = import.meta.env.BASE_URL;

const navLinks = [
  { href: `${base}`, label: 'Home' },
  { href: `${base}about/`, label: 'About' },
  { href: `${base}blog/`, label: 'Blog' },
  { href: `${base}training/`, label: 'Training' },
  { href: 'https://calculator.chironapp.com/', label: 'Running Calculator', external: true },
  { href: `${base}contact/`, label: 'Contact' },
];

const currentPath = Astro.url.pathname;
---

<header class="bg-white shadow-sm sticky top-0 z-50">
  <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <div class="flex-shrink-0">
        <a href={base} class="text-4xl font-logo text-primary-600">Chiron</a>
      </div>
      <div class="hidden md:block">
        <div class="ml-10 flex items-baseline space-x-4">
          {navLinks.map((link) => {
            const isHome = link.href === base;
            const isActive = !link.external && (currentPath === link.href || (!isHome && currentPath.startsWith(link.href)));
            
            return (
              <a
                href={link.href}
                target={link.external ? '_blank' : undefined}
                rel={link.external ? 'noopener noreferrer' : undefined}
                class:list={[
                  'px-3 py-2 rounded-md text-sm font-medium transition-colors',
                  isActive
                    ? 'bg-primary-100 text-primary-700'
                    : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900',
                ]}
              >
                {link.label}
              </a>
            );
          })}
        </div>
      </div>
      <div class="md:hidden">
        <button
          type="button"
          id="mobile-menu-button"
          class="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100"
          aria-expanded="false"
        >
          <span class="sr-only">Open main menu</span>
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>
    <div id="mobile-menu" class="hidden md:hidden pb-4">
      <div class="flex flex-col space-y-2">
        {navLinks.map((link) => {
          const isHome = link.href === base;
          const isActive = !link.external && (currentPath === link.href || (!isHome && currentPath.startsWith(link.href)));
          
          return (
            <a
              href={link.href}
              target={link.external ? '_blank' : undefined}
              rel={link.external ? 'noopener noreferrer' : undefined}
              class:list={[
                'px-3 py-2 rounded-md text-base font-medium',
                isActive
                  ? 'bg-primary-100 text-primary-700'
                  : 'text-gray-700 hover:bg-gray-100 hover:text-gray-900',
              ]}
            >
              {link.label}
            </a>
          );
        })}
      </div>
    </div>
  </nav>
</header>

<script>
  const button = document.getElementById('mobile-menu-button');
  const menu = document.getElementById('mobile-menu');
  
  button?.addEventListener('click', () => {
    const expanded = button.getAttribute('aria-expanded') === 'true';
    button.setAttribute('aria-expanded', (!expanded).toString());
    menu?.classList.toggle('hidden');
  });
</script>
