---
// Mailchimp Signup Component
// Clean, modern version of the Mailchimp form

const howUseOptions = [
  "Help plan and manage my own training",
  "I'm a coach and want to manage my athletes' training",
  "Iâ€™m a sports clinician and want to manage patient rehab and other programs",
  "I'm a race organiser and want to manage and time events",
  "Use AI to help improve planning and analysis"
];

const athleteTypeOptions = [
  "Runner",
  "Cyclist",
  "Triathlete",
  "General fitness enthusiast",
  "Other"
];
---

<div class="bg-primary-50 rounded-lg p-6 md:p-8">
  <h3 class="text-2xl font-bold text-gray-900 mb-2">Subscribe</h3>
  <p class="text-gray-600 mb-8">Get the latest training insights and be the first to know about new features.</p>
  
  <form 
    action="https://chironapp.us21.list-manage.com/subscribe/post?u=e0c9d80e1958ea530aa50f077&id=28fa8a4cee&f_id=00f55ae1f0" 
    method="post" 
    id="mc-embedded-subscribe-form" 
    name="mc-embedded-subscribe-form" 
    class="validate" 
    target="_blank"
    novalidate
  >
    <!-- Response Messages -->
    <div id="mce-responses" class="mb-6">
      <div class="response hidden p-4 rounded-md bg-red-50 border border-red-200" id="mce-error-response">
        <p class="text-red-600 text-sm"></p>
      </div>
      <div class="response hidden p-4 rounded-md bg-green-50 border border-green-200" id="mce-success-response">
        <p class="text-green-600 text-sm"></p>
      </div>
    </div>

    <!-- Name Field -->
    <div class="mb-6">
      <label for="mce-FNAME" class="block text-sm font-medium text-gray-700 mb-2">
        First Name
      </label>
      <input 
        type="text" 
        name="FNAME" 
        id="mce-FNAME" 
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-colors"
        placeholder="Enter your first name"
      />
    </div>

    <!-- Email Field -->
    <div class="mb-6">
      <label for="mce-EMAIL" class="block text-sm font-medium text-gray-700 mb-2">
        Email Address <span class="text-red-500">*</span>
      </label>
      <input 
        type="email" 
        name="EMAIL" 
        id="mce-EMAIL" 
        required 
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-colors"
        placeholder="Enter your email address"
      />
    </div>

    <!-- Beta Access -->
    <div class="mb-6">
      <fieldset>
        <legend class="block text-sm font-medium text-gray-700 mb-3">
          Interested in early access?
        </legend>
        <div class="space-y-2">
          <label class="flex items-center cursor-pointer">
            <input 
              type="radio" 
              name="BETA" 
              value="Yes" 
              class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"
            />
            <span class="ml-3 text-gray-700">Yes, I'd love early access!</span>
          </label>
          <label class="flex items-center cursor-pointer">
            <input 
              type="radio" 
              name="BETA" 
              value="No" 
              class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"
            />
            <span class="ml-3 text-gray-700">No, I'll wait for the official launch</span>
          </label>
        </div>
      </fieldset>
    </div>

    <!-- How will you use Chiron -->
    <div class="mb-6">
      <label for="mce-HOWUSE" class="block text-sm font-medium text-gray-700 mb-2">
        How do you hope to use Chiron?
      </label>
      <select 
        name="HOWUSE" 
        id="mce-HOWUSE"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-colors bg-white"
      >
        <option value="">Select an option</option>
        {howUseOptions.map((option) => (
          <option value={option}>{option}</option>
        ))}
      </select>
      <p class="mt-2 text-sm text-gray-500">Select the most relevant if more than one applies.</p>
    </div>

    <!-- Athlete Type -->
    <div class="mb-8">
      <label for="mce-TYPE" class="block text-sm font-medium text-gray-700 mb-2">
        What kind of athlete are you?
      </label>
      <select 
        name="TYPE" 
        id="mce-TYPE"
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-colors bg-white"
      >
        <option value="">Select your sport</option>
        {athleteTypeOptions.map((option) => (
          <option value={option}>{option}</option>
        ))}
      </select>
    </div>

    <!-- Bot Prevention -->
    <div style="position: absolute; left: -5000px;" aria-hidden="true">
      <input type="text" name="b_e0c9d80e1958ea530aa50f077_28fa8a4cee" tabindex="-1" value="" />
    </div>

    <!-- Submit Button -->
    <div class="text-center">
      <button 
        type="submit" 
        name="subscribe" 
        id="mc-embedded-subscribe"
        class="w-full bg-primary-600 text-white font-semibold py-4 px-8 rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-colors"
      >
        Subscribe
      </button>
    </div>

    <!-- Required Field Notice -->
    <p class="text-center text-xs text-gray-500 mt-4">
      <span class="text-red-500">*</span> Required field
    </p>
  </form>
</div>

<script>
// Enhanced form validation and submission handling
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('mc-embedded-subscribe-form');
  const errorResponse = document.getElementById('mce-error-response');
  const successResponse = document.getElementById('mce-success-response');

  if (form) {
    form.addEventListener('submit', function(e) {
      // Basic validation
      const email = document.getElementById('mce-EMAIL');
      if (email && !email.value) {
        e.preventDefault();
        showError('Please enter your email address.');
        return;
      }
      
      if (email && !isValidEmail(email.value)) {
        e.preventDefault();
        showError('Please enter a valid email address.');
        return;
      }

      // Clear any previous messages
      hideMessages();
      
      // Show loading state
      const submitButton = document.getElementById('mc-embedded-subscribe');
      if (submitButton) {
        submitButton.textContent = 'Subscribing...';
        submitButton.disabled = true;
      }
    });
  }

  function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }

  function showError(message) {
    if (errorResponse) {
      const messageElement = errorResponse.querySelector('p');
      if (messageElement) {
        messageElement.textContent = message;
      }
      errorResponse.classList.remove('hidden');
    }
    hideSuccess();
  }

  function showSuccess(message) {
    if (successResponse) {
      const messageElement = successResponse.querySelector('p');
      if (messageElement) {
        messageElement.textContent = message || 'Thank you for subscribing!';
      }
      successResponse.classList.remove('hidden');
    }
    hideError();
  }

  function hideError() {
    if (errorResponse) {
      errorResponse.classList.add('hidden');
    }
  }

  function hideSuccess() {
    if (successResponse) {
      successResponse.classList.add('hidden');
    }
  }

  function hideMessages() {
    hideError();
    hideSuccess();
  }
});
</script>